<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <title>Card Combo Generator</title>

  <!-- Choices.js CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/choices.js/public/assets/styles/choices.min.css" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

</head>

<body style="padding: 20px; background-color: #1c1c1c;">

  <div style="max-width: 1200px; margin: 30px auto; padding: 20px;">
    <div class="result-container" style="border: 1px solid grey; padding: 20px; background-color: white;">
      <!-- Selection Row -->
      <div style="display: block; margin-bottom: 15px;">

        <!-- Anchors Column -->
        <div style="">
          <h2 style="font-size: 1.2em; margin-bottom: 8px;">Select Anchors <em>(up to 4)</em> </h2>
          <select id="anchorSelect" multiple></select>
        </div>

        <!-- Savings Column -->
        <div style="margin-top: 10px;">
          <h2 style="font-size: 1.2em; margin-bottom: 8px;">Select Savings <em>(up to 4)</em></h2>
          <select id="savingsSelect" multiple></select>
        </div>

      </div>

      <!-- CS Calculation Mode Checkbox -->
      <div style="margin-bottom: 25px;">
        <input type="checkbox" id="useSSForCS" checked>
        <label for="useSSForCS">Use Savings SS % for CS Combo (Kristina's workaround)</label>
      </div>

      <!-- ðŸš€ EXPANDABLE GAP FACTOR ALERT -->
      <div
        style="background-color: #f9f9f9; border-left: 5px solid #2196F3; padding: 12px 16px; margin-bottom: 15px; font-size: 0.9em; color: #333;">

        <div style="display: flex; justify-content: space-between; align-items: center;">
          <strong>Gap Factor Explanation</strong>
          <button onclick="toggleGapFactorExplanation()"
            style="font-size: 0.8em; padding: 4px 8px; cursor: pointer;">Show
            More â–¼</button>
        </div>

        <div id="gapFactorExplanationContent" style="display: none; margin-top: 10px;">
          <p style="margin-bottom: 8px;">
            <strong>What is Gap Factor?</strong><br>
            Gap Factor controls how much margin (buffer) is required between the Combo % and the combined % of
            individual
            cards â€” to ensure the Combo % looks better to members.<br><br>
            - <strong>Gap Factor (SS) %</strong> â†’ applies to SuperSaver combos.<br>
            - <strong>Gap Factor (CS) %</strong> â†’ applies to ClubSaver combos.<br><br>
            A larger Gap Factor forces the individual cards to adjust lower â€” to make sure the Combo % clearly
            "wins."<br>
            Example: If Combo CS % = 10% and Gap Factor = 5%, then Individual Card Max % must be LESS than 9.5%.
          </p>
        </div>

      </div>



      <!-- GapFactor for SuperSaver -->
      <div style="margin-bottom: 10px;">
        <label for="gapFactorInput"><strong>Gap Factor (SS) %</strong>:</label>
        <input type="number" id="gapFactorInput" value="10" min="0" max="100" step="0.1"
          style="width: 80px; margin-left: 5px;">
      </div>

      <!-- GapFactor for ClubSaver -->
      <div style="margin-bottom: 15px;">
        <label for="gapFactorCSInput"><strong>Gap Factor (CS) %</strong>:</label>
        <input type="number" id="gapFactorCSInput" value="5" min="0" max="100" step="0.1"
          style="width: 80px; margin-left: 5px;">
      </div>


      <!-- Generate Combos Button -->
      <div style="margin-bottom: 15px;">
        <button onclick="generateCombos()" class="btn btn-primary">
          Generate Combos
        </button>
      </div>
    </div>



    <div class="result-container"
      style="background-color: #1c1c1c; color: #fff;">

      <div class="result-container"
      style="padding: 20px; margin: 60px 0px; background-color: #272727;">
    
        <!-- Combo Results -->
        <h2 style="font-size: 1.4em; border-bottom: 2px solid #ccc; padding-bottom: 5px;">Combo Results
        </h2>

        <!-- Alert -->
        <div id="comboAlert" class="alert alert-info" role="alert" style="margin-bottom: 15px; margin-top: 15px;">
          Choose Anchor and Savings cards to calculate combo.
        </div>

        <!-- Combo Table -->
        <table border="1" cellpadding="5" cellspacing="0"
          style="margin-bottom: 40px; width: 100%; display: none; margin-top: 30px; color: #1c1c1c; background-color: #fff;" class="comboResultTable">
          <thead style="background-color: #f1f1f1;">
            <tr style="">
              <th>Anchor</th>
              <th>Savings</th>
              <th>SS Combo %</th>
              <th>CS Combo %</th>
            </tr>
          </thead>
          <tbody id="comboResults">
          </tbody>
        </table>

      </div>

      

      <!-- Summary Section -->
      <div id="summarySection" style="display: none; margin-top: 40px;">

        <div class="summary-card-cont" style="padding: 20px; margin: 60px 0px; background-color: #272727;">
          <h2 style="font-size: 1.4em; border-bottom: 2px solid #ccc; padding-bottom: 5px;">Summary</h2>

          <div
            style="background: #fff; border: 1px solid #ddd; padding: 20px; border-radius: 8px; box-shadow: 0 1px 3px rgba(0,0,0,0.05); margin-bottom: 30px; margin-top: 30px;">
  
            <!-- First row: SS Summary -->
            <div style="display: flex; flex-wrap: wrap; gap: 20px; margin-bottom: 30px;">
              <div style="flex: 1; min-width: 250px; border: 1px solid #ccc; padding: 15px; border-radius: 8px; background-color: #eaf7eb;">
                <h3 style="font-size: 18px; color: #1c1c1c;">SS HIGHEST %</h3>
                <div id="ssHighest" style="font-size: 16px; font-weight: bold; color: #2e7d32;"></div>
              </div>
  
              <div style="flex: 1; min-width: 250px; border: 1px solid #ccc; padding: 15px; border-radius: 8px; background-color: #f7eaea;">
                <h3 style="font-size: 18px; color: #1c1c1c;">SS LOWEST %</h3>
                <div id="ssLowest" style="font-size: 16px; font-weight: bold; color: #c62828;"></div>
              </div>
  
              <div style="flex: 1; min-width: 250px; border: 1px solid #ccc; padding: 15px; border-radius: 8px; background-color: #eaf0f7;">
                <h3 style="font-size: 18px; color:#1c1c1c;">SS COMBO %</h3>
                <div id="ssCombo" style="font-size: 25px; font-weight: bold; color: #1565c0;"></div>
              </div>
            </div>
  
            <!-- Second row: CS Summary -->
            <div style="display: flex; flex-wrap: wrap; gap: 20px; ">
              <div style="flex: 1; min-width: 250px; border: 1px solid #ccc; padding: 15px; border-radius: 8px; background-color: #eaf7eb;">
                <h3 style="font-size: 18px; color: #1c1c1c;">CS HIGHEST %</h3>
                <div id="csHighest" style="font-size: 16px; font-weight: bold; color: #2e7d32;"></div>
              </div>
  
              <div style="flex: 1; min-width: 250px; border: 1px solid #ccc; padding: 15px; border-radius: 8px; background-color: #f7eaea;">
                <h3 style="font-size: 18px; color: #1c1c1c;">CS LOWEST %</h3>
                <div id="csLowest" style="font-size: 16px; font-weight: bold; color: #c62828;"></div>
              </div>
  
              <div style="flex: 1; min-width: 250px; border: 1px solid #ccc; padding: 15px; border-radius: 8px; background-color: #eaf0f7;">
                <h3 style="font-size: 18px; color:#1c1c1c;">CS COMBO %</h3>
                <div id="csCombo" style="font-size: 25px; font-weight: bold; color: #1565c0;"></div>
              </div>
            </div>
          </div>
        </div>
        

        <!-- ðŸš€ PART 6E â€” CLEANED UP ADJUSTMENT SECTION -->

        <!-- Adjustment Section Title -->
        <div id="adjustmentSection" style="display: none; margin-top: 40px;">
        <div class="adjustment-card-cont" style="padding: 20px; margin: 20px 0px; background-color: #272727;">
          <h2 style="font-size: 1.4em; border-bottom: 2px solid #ccc; padding-bottom: 5px;">Card %
            Adjustments (GapFactor)</h2>

          <table border="1" cellpadding="8" cellspacing="0"
            style="border-collapse: collapse; width: 100%; margin: 30px 0px; overflow-x: auto; color: #1c1c1c; background-color: #fff;">
            <thead style="background-color: #f8f8f8;">
              <tr style="border-bottom: 1px solid #ddd;">
                <th style="text-align: left;">Type</th>
                <th style="text-align: left;">Retailer</th>
                <th>SS %</th>
                <th>CS %</th>
                <th>SS ADJ %</th>
                <th>CS ADJ %</th>
              </tr>
            </thead>
            <tbody id="combinedAdjustments">
            </tbody>
          </table>
        </div>
          


          <!-- Adjustment Chart -->
          <div id="adjustmentChartSection" style="display: none;">

            <div class="summary-card-cont" style="padding: 20px; margin: 60px 0px; background-color: #272727;">
              <!-- ðŸš€ EXPANDABLE ADJUSTMENT CHART ALERT -->
            <div
            style="background-color: #f9f9f9; border-left: 5px solid #2196F3; padding: 12px 16px; margin-bottom: 15px; font-size: 0.9em; color: #333;">

            <div style="display: flex; justify-content: space-between; align-items: center;">
              <strong>Adjustment Chart Explanation</strong>
              <button onclick="toggleChartExplanation()"
                style="font-size: 0.8em; padding: 4px 8px; cursor: pointer;">Show
                More â–¼</button>
            </div>

            <div id="chartExplanationContent" style="display: none; margin-top: 10px;">
              <p style="margin-bottom: 8px;">
                <strong>How "Individual Card Max %" is calculated:</strong><br>
                This shows the best % a member could get by buying cards individually (instead of as a combo).<br>
                Formula = Highest Anchor % + Highest Savings % (after adjustments).<br>
                <u>SuperSaver:</u> Anchor SS ADJ % + Savings SS ADJ %<br>
                <u>ClubSaver:</u> Anchor CS ADJ % + Savings %:<br>
                &nbsp; - If Savings is not CS-available â†’ use SS ADJ %<br>
                &nbsp; - If Savings is CS-available â†’ use CS ADJ %
              </p>
            </div>

          </div>


          <table border="1" cellpadding="10" cellspacing="0" style="border-collapse: collapse; width: 100%; color: #1c1c1c; background-color: #fff; padding: 15px;">
            <thead style="background-color: #f1f1f1;">
              <tr>
                <th style="text-align: left;">Membership</th>
                <th>Card Combo %</th>
                <th>Individual Card Max %</th>
                <th>Individual Top Value Retailers</th>
              </tr>
            </thead>
            <tbody>
              <tr style="border-bottom: 1px solid #ddd;">
                <td>SuperSaver</td>
                <td id="chartSSCombo"></td>
                <td id="chartSSIndividual"></td>
                <td id="chartSSTopRetailers"></td>
              </tr>
              <tr style="border-bottom: 1px solid #ddd;">
                <td>ClubSaver</td>
                <td id="chartCSCombo"></td>
                <td id="chartCSIndividual"></td>
                <td id="chartCSTopRetailers"></td>
              </tr>
            </tbody>
          </table>
            </div>

            


          </div>

        </div>

      </div>




    </div>

  </div>





  <!-- Choices.js JS -->
  <script src="https://cdn.jsdelivr.net/npm/choices.js/public/assets/scripts/choices.min.js"></script>

  <!-- START JS -->
  <script src="./combo-script.js"></script>

</body>

</html>